<img src="https://github.com/mgbecerra/ProyectoGIPSN/raw/master/banner-GIPS.png" width="600">

### Política Electoral Subnacional: Análisis longitudinal de indicadores políticos

#### Elaborado por el [Grupo de Investigación de Política Subnacional](#team)

-----

```{r message=FALSE, warning=FALSE, include=FALSE, results='hide'}
#suppressPackageStartupMessages()
library(dplyr)
library(maptools)  
library(rgeos)
library(rgdal)
library(sf)
library(reshape2)
library(ggplot2) 
library(tmap)
library(maps)
library(plotrix)
library(scales)
library(kableExtra)
library(tidyverse)
```

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE, results='hide'}
peruframe=rgdal::readOGR("borderPeru.shp")
```

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
load("data_regional.Rda")
datareg=as.data.frame(data_regional)

gruposCantidad=3
etiquetas1=c('bajo','medio','alto')

datareg[c("NEPGR1", "NEPGR2", "NEPGR3", "NEPGR4", "NEPGR5")]=lapply(datareg[c("NEPGR02", "NEPGR06", "NEPGR10", "NEPGR14", "NEPGR18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datareg[c("concentracionGR1", "concentracionGR2", "concentracionGR3", "concentracionGR4", "concentracionGR5")]=lapply(datareg[c("concentracionGR02", "concentracionGR06", "concentracionGR10", "concentracionGR14", "concentracionGR18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datareg[c("competitividadGR1", "competitividadGR2", "competitividadGR3", "competitividadGR4", "competitividadGR5")]=lapply(datareg[c("competitividadGR02", "competitividadGR06", "competitividadGR10", "competitividadGR14", "competitividadGR18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datareg[c("ausentesGR1", "ausentesGR2", "ausentesGR3", "ausentesGR4", "ausentesGR5")]=lapply(datareg[c("por_ausentesGR02", "por_ausentesGR06", "por_ausentesGR10", "por_ausentesGR14", "por_ausentesGR18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

plgsR=rgdal::readOGR("DEPARTAMENTO_16_03_2015.shp")
plgsR  = merge(plgsR, datareg, by.x="IDDPTO", by.y="ID")
```


```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

load("data_provincial.Rda")
dataprov=as.data.frame(data_provincial)

gruposCantidad=3
etiquetas1=c('bajo','medio','alto')

dataprov[c("NEPGP1", "NEPGP2", "NEPGP3", "NEPGP4", "NEPGP5")]=lapply(dataprov[c("NEPGP02", "NEPGP06", "NEPGP10", "NEPGP14", "NEPGP18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

dataprov[c("concentracionGP1", "concentracionGP2", "concentracionGP3", "concentracionGP4", "concentracionGP5")]=lapply(dataprov[c("concentracionGP02", "concentracionGP06", "concentracionGP10", "concentracionGP14", "concentracionGP18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

dataprov[c("competitividadGP1", "competitividadGP2", "competitividadGP3", "competitividadGP4", "competitividadGP5")]=lapply(dataprov[c("competitividadGP02", "competitividadGP06", "competitividadGP10", "competitividadGP14", "competitividadGP18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

dataprov[c("ausentesGP1", "ausentesGP2", "ausentesGP3", "ausentesGP4", "ausentesGP5")]=lapply(dataprov[c("por_ausentesGP02", "por_ausentesGP06", "por_ausentesGP10", "por_ausentesGP14", "por_ausentesGP18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

plgsP=rgdal::readOGR("PROVINCIA_16_03_2015.shp")
plgsP  <- merge(plgsP, dataprov, by="ID") 
```

```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
load("data_distrital.Rda")
datadist=as.data.frame(data_distrital)

is.na(datadist)=sapply(datadist, is.infinite)

gruposCantidad=3
etiquetas1=c('bajo','medio','alto')

datadist[c("NEPGL1", "NEPGL2", "NEPGL3", "NEPGL4", "NEPGL5")]=lapply(datadist[c("NEPGL02", "NEPGL06", "NEPGL10", "NEPGL14", "NEPGL18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datadist[c("concentracionGL1", "concentracionGL2", "concentracionGL3", "concentracionGL4", "concentracionGL5")]=lapply(datadist[c("concentracionGL02", "concentracionGL06", "concentracionGL10", "concentracionGL14", "concentracionGL18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datadist[c("competitividadGL1", "competitividadGL2", "competitividadGL3", "competitividadGL4", "competitividadGL5")]=lapply(datadist[c("competitividadGL02", "competitividadGL06", "competitividadGL10", "competitividadGL14", "competitividadGL18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

datadist[c("ausentesGL1", "ausentesGL2", "ausentesGL3", "ausentesGL4", "ausentesGL5")]=lapply(datadist[c("por_ausentesGL02", "por_ausentesGL06", "por_ausentesGL10", "por_ausentesGL14", "por_ausentesGL18")],cut,
       breaks = gruposCantidad,
       labels = etiquetas1,
       ordered_result = T)

plgsD=rgdal::readOGR("DISTRITO_16_03_2015.shp")
plgsD  <- merge(plgsD, datadist, by="ID") 
```

El presente proyecto analiza la dimensión electoral de la política subnacional en el Perú. A partir del análisis de tres indicadores políticos, se buscan identificar los principales cambios y continuidades de la dinámica subnacional del país. Se contruye a partir del trabajo de Aragón (2010). 

  * [Fragmentación Electoral](#D0)
  * [Indicador de Competitividad](#D1)
  * [Indicador de Concentración](#D2)
  * [Ausentismo](#D3)

### Fragmentación Electoral

<a id='D0'></a> 

El concepto de fragmentación electoral alude a la dispersión de los votos emitidos en relación con las opciones políticas (partidos, organizaciones o candidatos) que compiten en una determinada elección. Un indicador comúnmente usado para medir el grado de fragmentación
electoral en un proceso electoral particular es el *Número Efectivo de Partidos (NEP).*

#### Elecciones Regionales 

**Estadisticos descriptivos: Indicador de Fragmentación Electoral (NEP) en las Elecciones Regionales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("NEPGR02",  "NEPGR06", "NEPGR10", "NEPGR14", "NEPGR18")

v_mean <- lapply(data_regional[vars], mean, na.rm=TRUE)
v_median <- lapply(data_regional[vars], median, na.rm=TRUE)
v_sd <- lapply(data_regional[vars], sd, na.rm=TRUE)
v_min <- lapply(data_regional[vars], min, na.rm=TRUE)
v_max <- lapply(data_regional[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Fragmentación Electoral (NEP) en las Elecciones Regionales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("NEPGR02",  "NEPGR06", "NEPGR10", "NEPGR14", "NEPGR18")
datareg2=datareg[vars]
names(datareg2) = c("2002", "2006", "2010", "2014", "2018")

datareg2=datareg2 %>% gather(Year, NEP)

ggplot(datareg2, aes(x=Year, y=NEP)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Fragmentacion Politica",x="") 
```

**Mapas Electorales: Indicador de Fragmentación Electoral (NEP) en las Elecciones Regionales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsR[!is.na(plgsR$NEPGR1) & plgsR$NEPGR1=="bajo",]
info_2 = plgsR[!is.na(plgsR$NEPGR1) & plgsR$NEPGR1=="medio",]
info_3 = plgsR[!is.na(plgsR$NEPGR1) & plgsR$NEPGR1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsR[!is.na(plgsR$NEPGR2) & plgsR$NEPGR2=="bajo",]
info_2 = plgsR[!is.na(plgsR$NEPGR2) & plgsR$NEPGR2=="medio",]
info_3 = plgsR[!is.na(plgsR$NEPGR2) & plgsR$NEPGR2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsR[!is.na(plgsR$NEPGR3) & plgsR$NEPGR3=="bajo",]
info_2 = plgsR[!is.na(plgsR$NEPGR3) & plgsR$NEPGR3=="medio",]
info_3 = plgsR[!is.na(plgsR$NEPGR3) & plgsR$NEPGR3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsR[!is.na(plgsR$NEPGR4) & plgsR$NEPGR4=="bajo",]
info_2 = plgsR[!is.na(plgsR$NEPGR4) & plgsR$NEPGR4=="medio",]
info_3 = plgsR[!is.na(plgsR$NEPGR4) & plgsR$NEPGR4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsR[!is.na(plgsR$NEPGR5) & plgsR$NEPGR5=="bajo",]
info_2 = plgsR[!is.na(plgsR$NEPGR5) & plgsR$NEPGR5=="medio",]
info_3 = plgsR[!is.na(plgsR$NEPGR5) & plgsR$NEPGR5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='NEP',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```


#### Elecciones Provinciales 

**Estadisticos descriptivos: Indicador de Fragmentación Electoral (NEP) en las Elecciones Provinciales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("NEPGP02",  "NEPGP06", "NEPGP10", "NEPGP14", "NEPGP18")

v_mean <- lapply(data_provincial[vars], mean, na.rm=TRUE)
v_median <- lapply(data_provincial[vars], median, na.rm=TRUE)
v_sd <- lapply(data_provincial[vars], sd, na.rm=TRUE)
v_min <- lapply(data_provincial[vars], min, na.rm=TRUE)
v_max <- lapply(data_provincial[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Fragmentación Electoral (NEP) en las Elecciones Provinciales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("NEPGP02",  "NEPGP06", "NEPGP10", "NEPGP14", "NEPGP18")
dataprov2=dataprov[vars]
names(dataprov2) = c("2002", "2006", "2010", "2014", "2018")

dataprov2=dataprov2 %>% gather(Year, NEP)

ggplot(dataprov2, aes(x=Year, y=NEP)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Fragmentacion Politica",x="") 
```

**Mapas Electorales: Indicador de Fragmentación Electoral (NEP) en las Elecciones Provinciales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsP[!is.na(plgsP$NEPGP1) & plgsP$NEPGP1=="bajo",]
info_2 = plgsP[!is.na(plgsP$NEPGP1) & plgsP$NEPGP1=="medio",]
info_3 = plgsP[ !is.na(plgsP$NEPGP1) & plgsP$NEPGP1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsP[!is.na(plgsP$NEPGP2) & plgsP$NEPGP2=="bajo",]
info_2 = plgsP[!is.na(plgsP$NEPGP2) & plgsP$NEPGP2=="medio",]
info_3 = plgsP[ !is.na(plgsP$NEPGP2) & plgsP$NEPGP2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsP[!is.na(plgsP$NEPGP3) & plgsP$NEPGP3=="bajo",]
info_2 = plgsP[!is.na(plgsP$NEPGP3) & plgsP$NEPGP3=="medio",]
info_3 = plgsP[ !is.na(plgsP$NEPGP3) & plgsP$NEPGP3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsP[!is.na(plgsP$NEPGP4) & plgsP$NEPGP4=="bajo",]
info_2 = plgsP[!is.na(plgsP$NEPGP4) & plgsP$NEPGP4=="medio",]
info_3 = plgsP[ !is.na(plgsP$NEPGP4) & plgsP$NEPGP4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsP[!is.na(plgsP$NEPGP5) & plgsP$NEPGP5=="bajo",]
info_2 = plgsP[!is.na(plgsP$NEPGP5) & plgsP$NEPGP5=="medio",]
info_3 = plgsP[ !is.na(plgsP$NEPGP5) & plgsP$NEPGP5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='NEP',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Elecciones Distritales 

**Estadisticos descriptivos: Indicador de Fragmentación Electoral (NEP) en las Elecciones Distritales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("NEPGL02",  "NEPGL06", "NEPGL10", "NEPGL14", "NEPGL18")

v_mean <- lapply(data_distrital[vars], mean, na.rm=TRUE)
v_median <- lapply(data_distrital[vars], median, na.rm=TRUE)
v_sd <- lapply(data_distrital[vars], sd, na.rm=TRUE)
v_min <- lapply(data_distrital[vars], min, na.rm=TRUE)
v_max <- lapply(data_distrital[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Fragmentación Electoral (NEP) en las Elecciones Distritales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("NEPGL02",  "NEPGL06", "NEPGL10", "NEPGL14", "NEPGL18")
datadist2=datadist[vars]
names(datadist2) = c("2002", "2006", "2010", "2014", "2018")

datadist2=datadist2 %>% gather(Year, NEP)

ggplot(datadist2, aes(x=Year, y=NEP)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Fragmentacion Politica",x="") 
```

**Mapas Electorales: Indicador de Fragmentación Electoral (NEP) en las Elecciones Distritales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsD[!is.na(plgsD$NEPGL1) & plgsD$NEPGL1=="bajo",]
info_2 = plgsD[!is.na(plgsD$NEPGL1) & plgsD$NEPGL1=="medio",]
info_3 = plgsD[ !is.na(plgsD$NEPGL1) & plgsD$NEPGL1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsD[!is.na(plgsD$NEPGL2) & plgsD$NEPGL2=="bajo",]
info_2 = plgsD[!is.na(plgsD$NEPGL2) & plgsD$NEPGL2=="medio",]
info_3 = plgsD[ !is.na(plgsD$NEPGL2) & plgsD$NEPGL2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsD[!is.na(plgsD$NEPGL3) & plgsD$NEPGL3=="bajo",]
info_2 = plgsD[!is.na(plgsD$NEPGL3) & plgsD$NEPGL3=="medio",]
info_3 = plgsD[ !is.na(plgsD$NEPGL3) & plgsD$NEPGL3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsD[!is.na(plgsD$NEPGL4) & plgsD$NEPGL4=="bajo",]
info_2 = plgsD[!is.na(plgsD$NEPGL4) & plgsD$NEPGL4=="medio",]
info_3 = plgsD[ !is.na(plgsD$NEPGL4) & plgsD$NEPGL4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsD[!is.na(plgsD$NEPGL5) & plgsD$NEPGL5=="bajo",]
info_2 = plgsD[!is.na(plgsD$NEPGL5) & plgsD$NEPGL5=="medio",]
info_3 = plgsD[ !is.na(plgsD$NEPGL5) & plgsD$NEPGL5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='NEP',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Análisis de Competitividad

<a id='D1'></a> 

El concepto de competitividad electoral alude a la distancia que se ha producido entre los partidos, organizaciones o candidatos que ocuparon el primer y el segundo lugar en un determinado proceso electoral. Por lo tanto el indicador comúnmente usado para medir el grado de competitividad registra la diferencia en la proporción de votos válidos emitidos entre las opciones electorales que quedaron en primer y segundo lugar.

#### Elecciones Regionales 

**Estadisticos descriptivos: Indicador de Competitividad en las Elecciones Regionales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("competitividadGR02",  "competitividadGR06", "competitividadGR10", "competitividadGR14", "competitividadGR18")

v_mean <- lapply(data_regional[vars], mean, na.rm=TRUE)
v_median <- lapply(data_regional[vars], median, na.rm=TRUE)
v_sd <- lapply(data_regional[vars], sd, na.rm=TRUE)
v_min <- lapply(data_regional[vars], min, na.rm=TRUE)
v_max <- lapply(data_regional[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Competitividad en las Elecciones Regionales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("competitividadGR02",  "competitividadGR06", "competitividadGR10", "competitividadGR14", "competitividadGR18")
datareg2=datareg[vars]
names(datareg2) = c("2002", "2006", "2010", "2014", "2018")

datareg2=datareg2 %>% gather(Year, competitividad)

ggplot(datareg2, aes(x=Year, y=competitividad)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Competitividad Politica",x="") 
```

**Mapas Electorales: Indicador de Competitividad en las Elecciones Regionales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsR[!is.na(plgsR$competitividadGR1) & plgsR$competitividadGR1=="bajo",]
info_2 = plgsR[!is.na(plgsR$competitividadGR1) & plgsR$competitividadGR1=="medio",]
info_3 = plgsR[!is.na(plgsR$competitividadGR1) & plgsR$competitividadGR1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsR[!is.na(plgsR$competitividadGR2) & plgsR$competitividadGR2=="bajo",]
info_2 = plgsR[!is.na(plgsR$competitividadGR2) & plgsR$competitividadGR2=="medio",]
info_3 = plgsR[!is.na(plgsR$competitividadGR2) & plgsR$competitividadGR2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsR[!is.na(plgsR$competitividadGR3) & plgsR$competitividadGR3=="bajo",]
info_2 = plgsR[!is.na(plgsR$competitividadGR3) & plgsR$competitividadGR3=="medio",]
info_3 = plgsR[!is.na(plgsR$competitividadGR3) & plgsR$competitividadGR3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsR[!is.na(plgsR$competitividadGR4) & plgsR$competitividadGR4=="bajo",]
info_2 = plgsR[!is.na(plgsR$competitividadGR4) & plgsR$competitividadGR4=="medio",]
info_3 = plgsR[!is.na(plgsR$competitividadGR4) & plgsR$competitividadGR4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsR[!is.na(plgsR$competitividadGR5) & plgsR$competitividadGR5=="bajo",]
info_2 = plgsR[!is.na(plgsR$competitividadGR5) & plgsR$competitividadGR5=="medio",]
info_3 = plgsR[!is.na(plgsR$competitividadGR5) & plgsR$competitividadGR5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Competitividad',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```


#### Elecciones Provinciales 

**Estadisticos descriptivos: Indicador de Competitividad en las Elecciones Provinciales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("competitividadGP02",  "competitividadGP06", "competitividadGP10", "competitividadGP14", "competitividadGP18")

v_mean <- lapply(data_provincial[vars], mean, na.rm=TRUE)
v_median <- lapply(data_provincial[vars], median, na.rm=TRUE)
v_sd <- lapply(data_provincial[vars], sd, na.rm=TRUE)
v_min <- lapply(data_provincial[vars], min, na.rm=TRUE)
v_max <- lapply(data_provincial[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Competitividad en las Elecciones Provinciales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("competitividadGP02",  "competitividadGP06", "competitividadGP10", "competitividadGP14", "competitividadGP18")
dataprov2=dataprov[vars]
names(dataprov2) = c("2002", "2006", "2010", "2014", "2018")

dataprov2=dataprov2 %>% gather(Year, competitividad)

ggplot(dataprov2, aes(x=Year, y=competitividad)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Competitividad Politica",x="") 
```

**Mapas Electorales: Indicador de Competitividad en las Elecciones Provinciales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsP[!is.na(plgsP$competitividadGP1) & plgsP$competitividadGP1=="bajo",]
info_2 = plgsP[!is.na(plgsP$competitividadGP1) & plgsP$competitividadGP1=="medio",]
info_3 = plgsP[ !is.na(plgsP$competitividadGP1) & plgsP$competitividadGP1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsP[!is.na(plgsP$competitividadGP2) & plgsP$competitividadGP2=="bajo",]
info_2 = plgsP[!is.na(plgsP$competitividadGP2) & plgsP$competitividadGP2=="medio",]
info_3 = plgsP[ !is.na(plgsP$competitividadGP2) & plgsP$competitividadGP2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsP[!is.na(plgsP$competitividadGP3) & plgsP$competitividadGP3=="bajo",]
info_2 = plgsP[!is.na(plgsP$competitividadGP3) & plgsP$competitividadGP3=="medio",]
info_3 = plgsP[ !is.na(plgsP$competitividadGP3) & plgsP$competitividadGP3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsP[!is.na(plgsP$competitividadGP4) & plgsP$competitividadGP4=="bajo",]
info_2 = plgsP[!is.na(plgsP$competitividadGP4) & plgsP$competitividadGP4=="medio",]
info_3 = plgsP[ !is.na(plgsP$competitividadGP4) & plgsP$competitividadGP4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsP[!is.na(plgsP$competitividadGP5) & plgsP$competitividadGP5=="bajo",]
info_2 = plgsP[!is.na(plgsP$competitividadGP5) & plgsP$competitividadGP5=="medio",]
info_3 = plgsP[ !is.na(plgsP$competitividadGP5) & plgsP$competitividadGP5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Competitividad',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```


#### Elecciones Distritales 

**Estadisticos descriptivos: Indicador de Competitividad en las Elecciones Distritales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("competitividadGL02",  "competitividadGL06", "competitividadGL10", "competitividadGL14", "competitividadGL18")

v_mean <- lapply(data_distrital[vars], mean, na.rm=TRUE)
v_median <- lapply(data_distrital[vars], median, na.rm=TRUE)
v_sd <- lapply(data_distrital[vars], sd, na.rm=TRUE)
v_min <- lapply(data_distrital[vars], min, na.rm=TRUE)
v_max <- lapply(data_distrital[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Competitividad en las Elecciones Distritales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("competitividadGL02",  "competitividadGL06", "competitividadGL10", "competitividadGL14", "competitividadGL18")
datadist2=datadist[vars]
names(datadist2) = c("2002", "2006", "2010", "2014", "2018")

datadist2=datadist2 %>% gather(Year, competitividad)

ggplot(datadist2, aes(x=Year, y=competitividad)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Competitividad Politica",x="") 
```

**Mapas Electorales: Indicador de Competitividad en las Elecciones Distritales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsD[!is.na(plgsD$competitividadGL1) & plgsD$competitividadGL1=="bajo",]
info_2 = plgsD[!is.na(plgsD$competitividadGL1) & plgsD$competitividadGL1=="medio",]
info_3 = plgsD[ !is.na(plgsD$competitividadGL1) & plgsD$competitividadGL1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsD[!is.na(plgsD$competitividadGL2) & plgsD$competitividadGL2=="bajo",]
info_2 = plgsD[!is.na(plgsD$competitividadGL2) & plgsD$competitividadGL2=="medio",]
info_3 = plgsD[ !is.na(plgsD$competitividadGL2) & plgsD$competitividadGL2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsD[!is.na(plgsD$competitividadGL3) & plgsD$competitividadGL3=="bajo",]
info_2 = plgsD[!is.na(plgsD$competitividadGL3) & plgsD$competitividadGL3=="medio",]
info_3 = plgsD[ !is.na(plgsD$competitividadGL3) & plgsD$competitividadGL3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsD[!is.na(plgsD$competitividadGL4) & plgsD$competitividadGL4=="bajo",]
info_2 = plgsD[!is.na(plgsD$competitividadGL4) & plgsD$competitividadGL4=="medio",]
info_3 = plgsD[ !is.na(plgsD$competitividadGL4) & plgsD$competitividadGL4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsD[!is.na(plgsD$competitividadGL5) & plgsD$competitividadGL5=="bajo",]
info_2 = plgsD[!is.na(plgsD$competitividadGL5) & plgsD$competitividadGL5=="medio",]
info_3 = plgsD[ !is.na(plgsD$competitividadGL5) & plgsD$competitividadGL5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Competitividad',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Análisis de Concentración

<a id='D2'></a> 

El concepto de concentración electoral alude a la capacidad que tuvieron las dos opciones electorales más votadas para atraer las preferencias electorales. El indicador de concentración electoral más comúnmente usado registra valores que van en un rango de 0 a 1, donde 0 corresponde al mínimo y 1 al máximo de la concentración electoral.

#### Elecciones Regionales 

**Estadisticos descriptivos: Indicador de Concentración en las Elecciones Regionales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("concentracionGR02",  "concentracionGR06", "concentracionGR10", "concentracionGR14", "concentracionGR18")

v_mean <- lapply(data_regional[vars], mean, na.rm=TRUE)
v_median <- lapply(data_regional[vars], median, na.rm=TRUE)
v_sd <- lapply(data_regional[vars], sd, na.rm=TRUE)
v_min <- lapply(data_regional[vars], min, na.rm=TRUE)
v_max <- lapply(data_regional[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Concentración Electoral en las Elecciones Regionales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("concentracionGR02",  "concentracionGR06", "concentracionGR10", "concentracionGR14", "concentracionGR18")
datareg2=datareg[vars]
names(datareg2) = c("2002", "2006", "2010", "2014", "2018")

datareg2=datareg2 %>% gather(Year, concentracion)

ggplot(datareg2, aes(x=Year, y=concentracion)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Concentracion Politica",x="") 
```

**Mapas Electorales: Indicador de Concentración en las Elecciones Regionales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsR[!is.na(plgsR$concentracionGR1) & plgsR$concentracionGR1=="bajo",]
info_2 = plgsR[!is.na(plgsR$concentracionGR1) & plgsR$concentracionGR1=="medio",]
info_3 = plgsR[!is.na(plgsR$concentracionGR1) & plgsR$concentracionGR1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsR[!is.na(plgsR$concentracionGR2) & plgsR$concentracionGR2=="bajo",]
info_2 = plgsR[!is.na(plgsR$concentracionGR2) & plgsR$concentracionGR2=="medio",]
info_3 = plgsR[!is.na(plgsR$concentracionGR2) & plgsR$concentracionGR2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsR[!is.na(plgsR$concentracionGR3) & plgsR$concentracionGR3=="bajo",]
info_2 = plgsR[!is.na(plgsR$concentracionGR3) & plgsR$concentracionGR3=="medio",]
info_3 = plgsR[!is.na(plgsR$concentracionGR3) & plgsR$concentracionGR3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsR[!is.na(plgsR$concentracionGR4) & plgsR$concentracionGR4=="bajo",]
info_2 = plgsR[!is.na(plgsR$concentracionGR4) & plgsR$concentracionGR4=="medio",]
info_3 = plgsR[!is.na(plgsR$concentracionGR4) & plgsR$concentracionGR4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsR[!is.na(plgsR$concentracionGR5) & plgsR$concentracionGR5=="bajo",]
info_2 = plgsR[!is.na(plgsR$concentracionGR5) & plgsR$concentracionGR5=="medio",]
info_3 = plgsR[!is.na(plgsR$concentracionGR5) & plgsR$concentracionGR5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Concentracion',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Elecciones Provinciales 

**Estadisticos descriptivos: Indicador de Concentración en las Elecciones Provinciales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("concentracionGP02",  "concentracionGP06", "concentracionGP10", "concentracionGP14", "concentracionGP18")

v_mean <- lapply(data_provincial[vars], mean, na.rm=TRUE)
v_median <- lapply(data_provincial[vars], median, na.rm=TRUE)
v_sd <- lapply(data_provincial[vars], sd, na.rm=TRUE)
v_min <- lapply(data_provincial[vars], min, na.rm=TRUE)
v_max <- lapply(data_provincial[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Concentración en las Elecciones Provinciales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("concentracionGP02",  "concentracionGP06", "concentracionGP10", "concentracionGP14", "concentracionGP18")
dataprov2=dataprov[vars]
names(dataprov2) = c("2002", "2006", "2010", "2014", "2018")

dataprov2=dataprov2 %>% gather(Year, concentracion)

ggplot(dataprov2, aes(x=Year, y=concentracion)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Concentracion Politica",x="") 
```

**Mapas Electorales: Indicador de Concentración en las Elecciones Provinciales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsP[!is.na(plgsP$concentracionGP1) & plgsP$concentracionGP1=="bajo",]
info_2 = plgsP[!is.na(plgsP$concentracionGP1) & plgsP$concentracionGP1=="medio",]
info_3 = plgsP[ !is.na(plgsP$concentracionGP1) & plgsP$concentracionGP1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsP[!is.na(plgsP$concentracionGP2) & plgsP$concentracionGP2=="bajo",]
info_2 = plgsP[!is.na(plgsP$concentracionGP2) & plgsP$concentracionGP2=="medio",]
info_3 = plgsP[ !is.na(plgsP$concentracionGP2) & plgsP$concentracionGP2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsP[!is.na(plgsP$concentracionGP3) & plgsP$concentracionGP3=="bajo",]
info_2 = plgsP[!is.na(plgsP$concentracionGP3) & plgsP$concentracionGP3=="medio",]
info_3 = plgsP[ !is.na(plgsP$concentracionGP3) & plgsP$concentracionGP3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsP[!is.na(plgsP$concentracionGP4) & plgsP$concentracionGP4=="bajo",]
info_2 = plgsP[!is.na(plgsP$concentracionGP4) & plgsP$concentracionGP4=="medio",]
info_3 = plgsP[ !is.na(plgsP$concentracionGP4) & plgsP$concentracionGP4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsP[!is.na(plgsP$concentracionGP5) & plgsP$concentracionGP5=="bajo",]
info_2 = plgsP[!is.na(plgsP$concentracionGP5) & plgsP$concentracionGP5=="medio",]
info_3 = plgsP[ !is.na(plgsP$concentracionGP5) & plgsP$concentracionGP5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Concentracion',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```


#### Elecciones Distritales 

**Estadisticos descriptivos: Indicador de Concentración en las Elecciones Distritales**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("concentracionGL02",  "concentracionGL06", "concentracionGL10", "concentracionGL14", "concentracionGL18")

v_mean <- lapply(data_distrital[vars], mean, na.rm=TRUE)
v_median <- lapply(data_distrital[vars], median, na.rm=TRUE)
v_sd <- lapply(data_distrital[vars], sd, na.rm=TRUE)
v_min <- lapply(data_distrital[vars], min, na.rm=TRUE)
v_max <- lapply(data_distrital[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Indicador de Concentración en las Elecciones Distritales**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("concentracionGL02",  "concentracionGL06", "concentracionGL10", "concentracionGL14", "concentracionGL18")
datadist2=datadist[vars]
names(datadist2) = c("2002", "2006", "2010", "2014", "2018")

datadist2=datadist2 %>% gather(Year, concentracion)

ggplot(datadist2, aes(x=Year, y=concentracion)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Concentracion Politica",x="") 
```

**Mapas Electorales: Indicador de Concentración en las Elecciones Distritales**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsD[!is.na(plgsD$concentracionGL1) & plgsD$concentracionGL1=="bajo",]
info_2 = plgsD[!is.na(plgsD$concentracionGL1) & plgsD$concentracionGL1=="medio",]
info_3 = plgsD[ !is.na(plgsD$concentracionGL1) & plgsD$concentracionGL1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsD[!is.na(plgsD$concentracionGL2) & plgsD$concentracionGL2=="bajo",]
info_2 = plgsD[!is.na(plgsD$concentracionGL2) & plgsD$concentracionGL2=="medio",]
info_3 = plgsD[ !is.na(plgsD$concentracionGL2) & plgsD$concentracionGL2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsD[!is.na(plgsD$concentracionGL3) & plgsD$concentracionGL3=="bajo",]
info_2 = plgsD[!is.na(plgsD$concentracionGL3) & plgsD$concentracionGL3=="medio",]
info_3 = plgsD[ !is.na(plgsD$concentracionGL3) & plgsD$concentracionGL3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsD[!is.na(plgsD$concentracionGL4) & plgsD$concentracionGL4=="bajo",]
info_2 = plgsD[!is.na(plgsD$concentracionGL4) & plgsD$concentracionGL4=="medio",]
info_3 = plgsD[ !is.na(plgsD$concentracionGL4) & plgsD$concentracionGL4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsD[!is.na(plgsD$concentracionGL5) & plgsD$concentracionGL5=="bajo",]
info_2 = plgsD[!is.na(plgsD$concentracionGL5) & plgsD$concentracionGL5=="medio",]
info_3 = plgsD[ !is.na(plgsD$concentracionGL5) & plgsD$concentracionGL5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Concentracion',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Ausentismo

<a id='D3'></a> 

#### Elecciones Regionales 

**Estadisticos descriptivos: Ausentismo a Nivel Regional**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("por_ausentesGR02",  "por_ausentesGR06", "por_ausentesGR10", "por_ausentesGR14", "por_ausentesGR18")

v_mean <- lapply(data_regional[vars], mean, na.rm=TRUE)
v_median <- lapply(data_regional[vars], median, na.rm=TRUE)
v_sd <- lapply(data_regional[vars], sd, na.rm=TRUE)
v_min <- lapply(data_regional[vars], min, na.rm=TRUE)
v_max <- lapply(data_regional[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Ausentismo a Nivel Regional**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("por_ausentesGR02",  "por_ausentesGR06", "por_ausentesGR10", "por_ausentesGR14", "por_ausentesGR18")
datareg2=datareg[vars]
names(datareg2) = c("2002", "2006", "2010", "2014", "2018")

datareg2=datareg2 %>% gather(Year, ausentes)

ggplot(datareg2, aes(x=Year, y=ausentes)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Ausentismo (%)",x="") 
```

**Mapas Electorales: Ausentismo a Nivel Regional**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsR[!is.na(plgsR$ausentesGR1) & plgsR$ausentesGR1=="bajo",]
info_2 = plgsR[!is.na(plgsR$ausentesGR1) & plgsR$ausentesGR1=="medio",]
info_3 = plgsR[!is.na(plgsR$ausentesGR1) & plgsR$ausentesGR1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsR[!is.na(plgsR$ausentesGR2) & plgsR$ausentesGR2=="bajo",]
info_2 = plgsR[!is.na(plgsR$ausentesGR2) & plgsR$ausentesGR2=="medio",]
info_3 = plgsR[!is.na(plgsR$ausentesGR2) & plgsR$ausentesGR2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsR[!is.na(plgsR$ausentesGR3) & plgsR$ausentesGR3=="bajo",]
info_2 = plgsR[!is.na(plgsR$ausentesGR3) & plgsR$ausentesGR3=="medio",]
info_3 = plgsR[!is.na(plgsR$ausentesGR3) & plgsR$ausentesGR3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsR[!is.na(plgsR$ausentesGR4) & plgsR$ausentesGR4=="bajo",]
info_2 = plgsR[!is.na(plgsR$ausentesGR4) & plgsR$ausentesGR4=="medio",]
info_3 = plgsR[!is.na(plgsR$ausentesGR4) & plgsR$ausentesGR4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsR[!is.na(plgsR$ausentesGR5) & plgsR$ausentesGR5=="bajo",]
info_2 = plgsR[!is.na(plgsR$ausentesGR5) & plgsR$ausentesGR5=="medio",]
info_3 = plgsR[!is.na(plgsR$ausentesGR5) & plgsR$ausentesGR5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA)
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Ausentismo',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```


#### Elecciones Provinciales 

**Estadisticos descriptivos: Ausentismo a Nivel Provincial**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("por_ausentesGP02",  "por_ausentesGP06", "por_ausentesGP10", "por_ausentesGP14", "por_ausentesGP18")

v_mean <- lapply(data_provincial[vars], mean, na.rm=TRUE)
v_median <- lapply(data_provincial[vars], median, na.rm=TRUE)
v_sd <- lapply(data_provincial[vars], sd, na.rm=TRUE)
v_min <- lapply(data_provincial[vars], min, na.rm=TRUE)
v_max <- lapply(data_provincial[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Ausentismo a Nivel Provincial**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("por_ausentesGP02",  "por_ausentesGP06", "por_ausentesGP10", "por_ausentesGP14", "por_ausentesGP18")
dataprov2=dataprov[vars]
names(dataprov2) = c("2002", "2006", "2010", "2014", "2018")

dataprov2=dataprov2 %>% gather(Year, ausentes)

ggplot(dataprov2, aes(x=Year, y=ausentes)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Ausentismo (%)",x="") 
```

**Mapas Electorales: Ausentismo a Nivel Provincial**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsP[!is.na(plgsP$ausentesGP1) & plgsP$ausentesGP1=="bajo",]
info_2 = plgsP[!is.na(plgsP$ausentesGP1) & plgsP$ausentesGP1=="medio",]
info_3 = plgsP[ !is.na(plgsP$ausentesGP1) & plgsP$ausentesGP1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsP[!is.na(plgsP$ausentesGP2) & plgsP$ausentesGP2=="bajo",]
info_2 = plgsP[!is.na(plgsP$ausentesGP2) & plgsP$ausentesGP2=="medio",]
info_3 = plgsP[ !is.na(plgsP$ausentesGP2) & plgsP$ausentesGP2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsP[!is.na(plgsP$ausentesGP3) & plgsP$ausentesGP3=="bajo",]
info_2 = plgsP[!is.na(plgsP$ausentesGP3) & plgsP$ausentesGP3=="medio",]
info_3 = plgsP[ !is.na(plgsP$ausentesGP3) & plgsP$ausentesGP3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsP[!is.na(plgsP$ausentesGP4) & plgsP$ausentesGP4=="bajo",]
info_2 = plgsP[!is.na(plgsP$ausentesGP4) & plgsP$ausentesGP4=="medio",]
info_3 = plgsP[ !is.na(plgsP$ausentesGP4) & plgsP$ausentesGP4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsP[!is.na(plgsP$ausentesGP5) & plgsP$ausentesGP5=="bajo",]
info_2 = plgsP[!is.na(plgsP$ausentesGP5) & plgsP$ausentesGP5=="medio",]
info_3 = plgsP[ !is.na(plgsP$ausentesGP5) & plgsP$ausentesGP5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Ausentismo',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

#### Elecciones Distritales 

**Estadisticos descriptivos: Ausentismo a Nivel Distrital**

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
vars=c("por_ausentesGL02",  "por_ausentesGL06", "por_ausentesGL10", "por_ausentesGL14", "por_ausentesGL18")

v_mean <- lapply(data_distrital[vars], mean, na.rm=TRUE)
v_median <- lapply(data_distrital[vars], median, na.rm=TRUE)
v_sd <- lapply(data_distrital[vars], sd, na.rm=TRUE)
v_min <- lapply(data_distrital[vars], min, na.rm=TRUE)
v_max <- lapply(data_distrital[vars], max, na.rm=TRUE)

v_mean <- round(as.numeric(v_mean), 2)
v_median <- round(as.numeric(v_median), 2)
v_sd <- round(as.numeric(v_sd), 2)
v_min <- round(as.numeric(v_min), 2)
v_max <- round(as.numeric(v_max), 2)

v_tab <- cbind(media=v_mean, mediana=v_median,sd=v_sd,min=v_min, max=v_max)
row.names(v_tab) = c("2002", "2006", "2010", "2014", "2018")

v_tab=as.data.frame(t(v_tab))

kable(v_tab)  %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

**Evolución en el tiempo: Ausentismo a Nivel Distrital**

```{r echo=FALSE, fig.height=2.5,  message=FALSE, warning=FALSE}
vars=c("por_ausentesGL02",  "por_ausentesGL06", "por_ausentesGL10", "por_ausentesGL14", "por_ausentesGL18")
datadist2=datadist[vars]
names(datadist2) = c("2002", "2006", "2010", "2014", "2018")

datadist2=datadist2 %>% gather(Year, ausentes)

ggplot(datadist2, aes(x=Year, y=ausentes)) + geom_boxplot(outlier.colour="black", outlier.shape=16,
             outlier.size=2, notch=T,fill='steelblue') +
    	    theme(panel.background=element_rect(fill = "white", colour = "black"))+ labs( y="Nivel de Ausentismo (%)",x="") 
```

**Mapas Electorales: Ausentismo a Nivel Distrital**

```{r, eval=TRUE, echo=FALSE, fig.height=6, fig.show='hold', fig.width=8, message=FALSE, warning=FALSE, paged.print=FALSE}
library(maps)

par(mfrow=c(2,3))

# Elecciones 2002
info_1 = plgsD[!is.na(plgsD$ausentesGL1) & plgsD$ausentesGL1=="bajo",]
info_2 = plgsD[!is.na(plgsD$ausentesGL1) & plgsD$ausentesGL1=="medio",]
info_3 = plgsD[ !is.na(plgsD$ausentesGL1) & plgsD$ausentesGL1=="alto",]

plot(peruframe, main="2002",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2006
info_1 = plgsD[!is.na(plgsD$ausentesGL2) & plgsD$ausentesGL2=="bajo",]
info_2 = plgsD[!is.na(plgsD$ausentesGL2) & plgsD$ausentesGL2=="medio",]
info_3 = plgsD[ !is.na(plgsD$ausentesGL2) & plgsD$ausentesGL2=="alto",]

plot(peruframe, main="2006",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2010
info_1 = plgsD[!is.na(plgsD$ausentesGL3) & plgsD$ausentesGL3=="bajo",]
info_2 = plgsD[!is.na(plgsD$ausentesGL3) & plgsD$ausentesGL3=="medio",]
info_3 = plgsD[ !is.na(plgsD$ausentesGL3) & plgsD$ausentesGL3=="alto",]

plot(peruframe, main="2010",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2014
info_1 = plgsD[!is.na(plgsD$ausentesGL4) & plgsD$ausentesGL4=="bajo",]
info_2 = plgsD[!is.na(plgsD$ausentesGL4) & plgsD$ausentesGL4=="medio",]
info_3 = plgsD[ !is.na(plgsD$ausentesGL4) & plgsD$ausentesGL4=="alto",]

plot(peruframe, main="2014",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones 2018
info_1 = plgsD[!is.na(plgsD$ausentesGL5) & plgsD$ausentesGL5=="bajo",]
info_2 = plgsD[!is.na(plgsD$ausentesGL5) & plgsD$ausentesGL5=="medio",]
info_3 = plgsD[ !is.na(plgsD$ausentesGL5) & plgsD$ausentesGL5=="alto",]

plot(peruframe, main="2018",cex.main=1.5,border=NA, col="lightgrey")
plot(info_1,col='#ffeda0',lty=0,add = TRUE,border=NA)
plot(info_2,col='#feb24c',lty=0,add = TRUE,border=NA)
plot(info_3,col='#f03b20',lty=0,add = TRUE,border=NA)

# Elecciones leyenda

plot(peruframe, col="white",border=NA)

legend("center",title='Ausentismo',
       legend=c("Bajo", "Medio", "Alto"),
       fill=c('#ffeda0','#feb24c',"#f03b20"),cex=1.2,bty = "n")

```

------

<a id='team'></a>

**El equipo del GIPSN está conformado por:**

* Jorge Aragón
* Francisco Aguilar
* María Gracia Becerra
